<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FidEx Admin</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<section>

<!-- LOGIN SCREEN -->
<div class="product-box" id="loginBox">
    <h2>Executive Login</h2>
    <input type="password" id="adminCode" placeholder="Enter Access Code">
    <button class="order-btn" onclick="login()">Login</button>
</div>
<div id="adminDashboard" style="display:none;">

    <h2>Executive Dashboard</h2>

    <div class="stats-box">
        <div class="stat">Total Orders: <span id="totalOrders">0</span></div>
        <div class="stat">Total Revenue: ‚Ç¶<span id="totalRevenue">0</span></div>
        <div class="stat">Total Customers: <span id="totalCustomers">0</span></div>
        <div class="stat">Orders Today: <span id="ordersToday">0</span></div>
        <div class="stat">Top Customer: <span id="topCustomer">-</span></div>
    </div>

    <hr>

    <h3>All Orders</h3>
    <div id="adminOrders"></div>

    <button onclick="clearOrders()" class="order-btn" style="background:#b22222;">
        Clear All Orders
    </button>

</div>
<!-- ADMIN PANEL (hidden completely) -->



</section>

<script>

const ACCESS_CODE = "FIDEX2026";

// üîê Force login before anything loads
document.addEventListener("DOMContentLoaded", () => {
    if (sessionStorage.getItem("fidexAdminAuth") === "true") {
        showAdmin();
    } else {
        document.getElementById("loginBox").style.display = "block";
        document.getElementById("adminPanel").style.display = "none";
    }
});

function login() {
    let code = document.getElementById("adminCode").value;

    if (code === ACCESS_CODE) {
        sessionStorage.setItem("fidexAdminAuth", "true");
        showAdmin();
    } else {
        alert("Incorrect Access Code");
    }
}

function logout() {
    sessionStorage.removeItem("fidexAdminAuth");
    location.reload();
}

function showAdmin() {
    document.getElementById("loginBox").style.display = "none";
    document.getElementById("adminPanel").style.display = "block";
    loadOrders();
}

function loadOrders() {

    if (sessionStorage.getItem("fidexAdminAuth") !== "true") return;

    let orders = JSON.parse(localStorage.getItem("fidexOrders")) || [];
    let container = document.getElementById("orders");
    let analyticsBox = document.getElementById("analytics");

    if (orders.length === 0) {
        container.innerHTML = "No orders yet.";
        analyticsBox.innerHTML = "";
        return;
    }

    // üìä Analytics
    let totalRevenue = 0;
    let totalPacks = 0;

    orders.forEach(order => {
        totalRevenue += order.total;
        totalPacks += order.quantity;
    });

    analyticsBox.innerHTML = `
        <strong>Total Revenue:</strong> ‚Ç¶${totalRevenue}<br>
        <strong>Total Packs Sold:</strong> ${totalPacks}<br>
        <strong>Total Orders:</strong> ${orders.length}
        <hr>
    `;

    // üìÅ Group by Name
    let grouped = {};

    orders.forEach(order => {
        if (!grouped[order.name]) {
            grouped[order.name] = [];
        }
        grouped[order.name].push(order);
    });

    let html = "";

    for (let customer in grouped) {
        html += `<h3>üìÅ ${customer}</h3>`;

        grouped[customer].forEach(order => {
            html += `
            <div style="border:1px solid #ccc; padding:8px; margin:8px 0;">
                <strong>Ref:</strong> ${order.ref}<br>
                Quantity: ${order.quantity}<br>
                Total: ‚Ç¶${order.total}<br>
                Phone: ${order.phone}<br>
                Location: ${order.location}<br>
                <small>${order.date}</small>
            </div>`;
        });
    }

    container.innerHTML = html;
}

function clearOrders() {
    if (sessionStorage.getItem("fidexAdminAuth") !== "true") return;

    if (confirm("Delete ALL orders permanently?")) {
        localStorage.removeItem("fidexOrders");
        loadOrders();
    }
}

</script>

</body>
</html>